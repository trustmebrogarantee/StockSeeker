(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();const Or=6048e5,zr=864e5,_t=Symbol.for("constructDateFrom");function I(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&_t in t?t[_t](e):t instanceof Date?new t.constructor(e):new Date(e)}function q(t,e){return I(e||t,t)}let Gr={};function U(){return Gr}function G(t,e){var s,c,l,h;const r=U(),n=(e==null?void 0:e.weekStartsOn)??((c=(s=e==null?void 0:e.locale)==null?void 0:s.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((h=(l=r.locale)==null?void 0:l.options)==null?void 0:h.weekStartsOn)??0,a=q(t,e==null?void 0:e.in),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function J(t,e){return G(t,{...e,weekStartsOn:1})}function kr(t,e){const r=q(t,e==null?void 0:e.in),n=r.getFullYear(),a=I(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=J(a),o=I(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const s=J(o);return r.getTime()>=i.getTime()?n+1:r.getTime()>=s.getTime()?n:n-1}function St(t){const e=q(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function Vr(t,...e){const r=I.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function nt(t,e){const r=q(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function Br(t,e,r){const[n,a]=Vr(r==null?void 0:r.in,t,e),i=nt(n),o=nt(a),s=+i-St(i),c=+o-St(o);return Math.round((s-c)/zr)}function Xr(t,e){const r=kr(t,e),n=I(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),J(n)}function Kr(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Qr(t){return!(!Kr(t)&&typeof t!="number"||isNaN(+q(t)))}function $r(t,e){const r=q(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const Jr={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ur=(t,e,r)=>{let n;const a=Jr[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function re(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const Zr={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},en={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},tn={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},rn={date:re({formats:Zr,defaultWidth:"full"}),time:re({formats:en,defaultWidth:"full"}),dateTime:re({formats:tn,defaultWidth:"full"})},nn={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},an=(t,e,r,n)=>nn[t];function Y(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,s=r!=null&&r.width?String(r.width):o;a=t.formattingValues[s]||t.formattingValues[o]}else{const o=t.defaultWidth,s=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[s]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return a[i]}}const sn={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},on={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},cn={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ln={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},un={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},hn={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},dn=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},fn={ordinalNumber:dn,era:Y({values:sn,defaultWidth:"wide"}),quarter:Y({values:on,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Y({values:cn,defaultWidth:"wide"}),day:Y({values:ln,defaultWidth:"wide"}),dayPeriod:Y({values:un,defaultWidth:"wide",formattingValues:hn,defaultFormattingWidth:"wide"})};function z(t){return(e,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=e.match(a);if(!i)return null;const o=i[0],s=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(s)?gn(s,d=>d.test(o)):mn(s,d=>d.test(o));let l;l=t.valueCallback?t.valueCallback(c):c,l=r.valueCallback?r.valueCallback(l):l;const h=e.slice(o.length);return{value:l,rest:h}}}function mn(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function gn(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function vn(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const a=n[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const s=e.slice(a.length);return{value:o,rest:s}}}const pn=/^(\d+)(th|st|nd|rd)?/i,yn=/\d+/i,bn={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},wn={any:[/^b/i,/^(a|c)/i]},_n={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Sn={any:[/1/i,/2/i,/3/i,/4/i]},xn={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Pn={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Cn={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Mn={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Tn={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},On={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},kn={ordinalNumber:vn({matchPattern:pn,parsePattern:yn,valueCallback:t=>parseInt(t,10)}),era:z({matchPatterns:bn,defaultMatchWidth:"wide",parsePatterns:wn,defaultParseWidth:"any"}),quarter:z({matchPatterns:_n,defaultMatchWidth:"wide",parsePatterns:Sn,defaultParseWidth:"any",valueCallback:t=>t+1}),month:z({matchPatterns:xn,defaultMatchWidth:"wide",parsePatterns:Pn,defaultParseWidth:"any"}),day:z({matchPatterns:Cn,defaultMatchWidth:"wide",parsePatterns:Mn,defaultParseWidth:"any"}),dayPeriod:z({matchPatterns:Tn,defaultMatchWidth:"any",parsePatterns:On,defaultParseWidth:"any"})},Dn={code:"en-US",formatDistance:Ur,formatLong:rn,formatRelative:an,localize:fn,match:kn,options:{weekStartsOn:0,firstWeekContainsDate:1}};function qn(t,e){const r=q(t,e==null?void 0:e.in);return Br(r,$r(r))+1}function En(t,e){const r=q(t,e==null?void 0:e.in),n=+J(r)-+Xr(r);return Math.round(n/Or)+1}function Dr(t,e){var h,d,g,v;const r=q(t,e==null?void 0:e.in),n=r.getFullYear(),a=U(),i=(e==null?void 0:e.firstWeekContainsDate)??((d=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(g=a.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)??1,o=I((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const s=G(o,e),c=I((e==null?void 0:e.in)||t,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const l=G(c,e);return+r>=+s?n+1:+r>=+l?n:n-1}function Rn(t,e){var s,c,l,h;const r=U(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(s=e==null?void 0:e.locale)==null?void 0:s.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((h=(l=r.locale)==null?void 0:l.options)==null?void 0:h.firstWeekContainsDate)??1,a=Dr(t,e),i=I((e==null?void 0:e.in)||t,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),G(i,e)}function Ln(t,e){const r=q(t,e==null?void 0:e.in),n=+G(r,e)-+Rn(r,e);return Math.round(n/Or)+1}function _(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const A={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return _(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):_(r+1,2)},d(t,e){return _(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return _(t.getHours()%12||12,e.length)},H(t,e){return _(t.getHours(),e.length)},m(t,e){return _(t.getMinutes(),e.length)},s(t,e){return _(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return _(a,e.length)}},j={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},xt={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return A.y(t,e)},Y:function(t,e,r,n){const a=Dr(t,n),i=a>0?a:1-a;if(e==="YY"){const o=i%100;return _(o,2)}return e==="Yo"?r.ordinalNumber(i,{unit:"year"}):_(i,e.length)},R:function(t,e){const r=kr(t);return _(r,e.length)},u:function(t,e){const r=t.getFullYear();return _(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return _(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return _(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return A.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return _(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const a=Ln(t,n);return e==="wo"?r.ordinalNumber(a,{unit:"week"}):_(a,e.length)},I:function(t,e,r){const n=En(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):_(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):A.d(t,e)},D:function(t,e,r){const n=qn(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):_(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const a=t.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return _(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const a=t.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return _(i,e.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),a=n===0?7:n;switch(e){case"i":return String(a);case"ii":return _(a,e.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let a;switch(n===12?a=j.noon:n===0?a=j.midnight:a=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let a;switch(n>=17?a=j.evening:n>=12?a=j.afternoon:n>=4?a=j.morning:a=j.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return A.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):A.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):_(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):_(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):A.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):A.s(t,e)},S:function(t,e){return A.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return Ct(n);case"XXXX":case"XX":return H(n);case"XXXXX":case"XXX":default:return H(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return Ct(n);case"xxxx":case"xx":return H(n);case"xxxxx":case"xxx":default:return H(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Pt(n,":");case"OOOO":default:return"GMT"+H(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Pt(n,":");case"zzzz":default:return"GMT"+H(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return _(n,e.length)},T:function(t,e,r){return _(+t,e.length)}};function Pt(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+e+_(i,2)}function Ct(t,e){return t%60===0?(t>0?"-":"+")+_(Math.abs(t)/60,2):H(t,e)}function H(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=_(Math.trunc(n/60),2),i=_(n%60,2);return r+a+e+i}const Mt=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},qr=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},An=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return Mt(t,e);let i;switch(n){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",Mt(n,e)).replace("{{time}}",qr(a,e))},In={p:qr,P:An},Fn=/^D+$/,Hn=/^Y+$/,Nn=["D","DD","YY","YYYY"];function Wn(t){return Fn.test(t)}function jn(t){return Hn.test(t)}function Yn(t,e,r){const n=zn(t,e,r);if(console.warn(n),Nn.includes(t))throw new RangeError(n)}function zn(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Gn=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Vn=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Bn=/^'([^]*?)'?$/,Xn=/''/g,Kn=/[a-zA-Z]/;function Tt(t,e,r){var h,d,g,v;const n=U(),a=n.locale??Dn,i=n.firstWeekContainsDate??((d=(h=n.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??1,o=n.weekStartsOn??((v=(g=n.locale)==null?void 0:g.options)==null?void 0:v.weekStartsOn)??0,s=q(t,r==null?void 0:r.in);if(!Qr(s))throw new RangeError("Invalid time value");let c=e.match(Vn).map(m=>{const y=m[0];if(y==="p"||y==="P"){const f=In[y];return f(m,a.formatLong)}return m}).join("").match(Gn).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const y=m[0];if(y==="'")return{isToken:!1,value:Qn(m)};if(xt[y])return{isToken:!0,value:m};if(y.match(Kn))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:m}});a.localize.preprocessor&&(c=a.localize.preprocessor(s,c));const l={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return c.map(m=>{if(!m.isToken)return m.value;const y=m.value;(jn(y)||Wn(y))&&Yn(y,e,String(t));const f=xt[y[0]];return f(s,y,a.localize,l)}).join("")}function Qn(t){const e=t.match(Bn);return e?e[1].replace(Xn,"'"):t}const K=t=>{let e=t[0];for(const r of t)r<e&&(e=r);return e},Q=t=>{let e=t[0];for(const r of t)r>e&&(e=r);return e},$n=(t,e,{x:r,highY:n,lowY:a,candleWidth:i,clusterFiltration:o,evaluations:s})=>{t.beginPath(),t.lineWidth=1;const c=Object.values(e).sort((g,v)=>v.price-g.price),l=Math.min(n,a),d=(Math.abs(n-a)||1)/c.length;for(let g=0;g<c.length;g++){const v=c[g],m=r-i/2,y=l+d*g;t.fillStyle=v.volume>=o?"purple":"#16355161",t.fillRect(m,y,i,d),t.font=`${Math.floor(i*.15)}px serif`,v.absorption<0?(t.fillStyle="blue",t.fillRect(m,y,i,d)):v.absorption>0&&(t.fillStyle="orange",t.fillRect(m,y,i,d)),t.textAlign="left",t.fillStyle=v.position==="upper-wick"?"green":v.position==="lower-wick"?"red":"black",t.fillText(`${parseInt(v.bid)}x${parseInt(v.ask)}`,m,y+i*.12);const f=v.evaluation;if(f>=5){t.fillStyle="#6813f152";const b=5*f*.2,S=b*.5;t.fillRect(r-S,y-S+d*.5,b,b)}}},Jn=(t,{x:e,openY:r,closeY:n,highY:a,lowY:i,isRising:o},{upColor:s,downColor:c,candleWidth:l,wickColor:h,clusters:d,clusterFiltration:g,evaluations:v,extra:m})=>{t.beginPath(),t.strokeStyle=h,t.lineWidth=1,t.moveTo(e,a),t.lineTo(e,i),t.stroke(),t.fillStyle=o?s:c;const y=Math.min(r,n),f=Math.abs(r-n)||1;t.fillRect(e-l/2,y,l,f),d&&$n(t,d,{x:e,highY:a,lowY:i,candleWidth:l,clusterFiltration:g,evaluations:v});const b=Math.min(a,i),S=Math.abs(a-i)||1;if(m.evaluations.positiveVD>1){t.beginPath();const w=Math.sqrt(1*m.evaluations.positiveVD)*2;t.fillStyle="#008000c7",t.arc(e,b+S+w+1,w,0,2*Math.PI),t.fill()}if(m.evaluations.negativeVD>1){t.beginPath();const w=Math.sqrt(1*m.evaluations.negativeVD)*2;t.fillStyle="#f713138c",t.arc(e,b-w*2-1,w,0,2*Math.PI),t.fill()}},Ot=t=>{const e=new Date(t.time),r=nt(new Date(t.time));return{x:t.time,o:t.open,c:t.close,l:t.low,h:t.high,extra:{id:t.id,cvd:t.cvd,clusters:t.clusters,volumeDelta:t.volumeDelta,priceDelta:t.priceDelta,volume:t.volume,evaluations:t.evaluations,startOfDayTimestamp:r.getTime(),startOfDayDateFormatted:Tt(r,"dd MMM"),dateFormatted:Tt(e,"HH:mm dd MMM")}}},Un=(t,e,r)=>Math.min(r,Math.max(e,t)),F=(t,e)=>{const[r,n]=t,[a,i]=e;return r<=i&&n>=a?{isOverlapping:!0,firstPoint:Math.max(r,a),lastPoint:Math.min(n,i)}:{isOverlapping:!1}};var $=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Er(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ne,kt;function ft(){if(kt)return ne;kt=1;var t=Array.isArray;return ne=t,ne}var ae,Dt;function Zn(){if(Dt)return ae;Dt=1;var t=typeof $=="object"&&$&&$.Object===Object&&$;return ae=t,ae}var ie,qt;function mt(){if(qt)return ie;qt=1;var t=Zn(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return ie=r,ie}var se,Et;function gt(){if(Et)return se;Et=1;var t=mt(),e=t.Symbol;return se=e,se}var oe,Rt;function ea(){if(Rt)return oe;Rt=1;var t=gt(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,a=t?t.toStringTag:void 0;function i(o){var s=r.call(o,a),c=o[a];try{o[a]=void 0;var l=!0}catch{}var h=n.call(o);return l&&(s?o[a]=c:delete o[a]),h}return oe=i,oe}var ce,Lt;function ta(){if(Lt)return ce;Lt=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return ce=r,ce}var le,At;function Rr(){if(At)return le;At=1;var t=gt(),e=ea(),r=ta(),n="[object Null]",a="[object Undefined]",i=t?t.toStringTag:void 0;function o(s){return s==null?s===void 0?a:n:i&&i in Object(s)?e(s):r(s)}return le=o,le}var ue,It;function ra(){if(It)return ue;It=1;function t(e){return e!=null&&typeof e=="object"}return ue=t,ue}var he,Ft;function vt(){if(Ft)return he;Ft=1;var t=Rr(),e=ra(),r="[object Symbol]";function n(a){return typeof a=="symbol"||e(a)&&t(a)==r}return he=n,he}var de,Ht;function na(){if(Ht)return de;Ht=1;var t=ft(),e=vt(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,o){if(t(i))return!1;var s=typeof i;return s=="number"||s=="symbol"||s=="boolean"||i==null||e(i)?!0:n.test(i)||!r.test(i)||o!=null&&i in Object(o)}return de=a,de}var fe,Nt;function Lr(){if(Nt)return fe;Nt=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return fe=t,fe}var me,Wt;function aa(){if(Wt)return me;Wt=1;var t=Rr(),e=Lr(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",i="[object Proxy]";function o(s){if(!e(s))return!1;var c=t(s);return c==n||c==a||c==r||c==i}return me=o,me}var ge,jt;function ia(){if(jt)return ge;jt=1;var t=mt(),e=t["__core-js_shared__"];return ge=e,ge}var ve,Yt;function sa(){if(Yt)return ve;Yt=1;var t=ia(),e=function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!e&&e in n}return ve=r,ve}var pe,zt;function oa(){if(zt)return pe;zt=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return pe=r,pe}var ye,Gt;function ca(){if(Gt)return ye;Gt=1;var t=aa(),e=sa(),r=Lr(),n=oa(),a=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,o=Function.prototype,s=Object.prototype,c=o.toString,l=s.hasOwnProperty,h=RegExp("^"+c.call(l).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(g){if(!r(g)||e(g))return!1;var v=t(g)?h:i;return v.test(n(g))}return ye=d,ye}var be,Vt;function la(){if(Vt)return be;Vt=1;function t(e,r){return e==null?void 0:e[r]}return be=t,be}var we,Bt;function Ar(){if(Bt)return we;Bt=1;var t=ca(),e=la();function r(n,a){var i=e(n,a);return t(i)?i:void 0}return we=r,we}var _e,Xt;function Z(){if(Xt)return _e;Xt=1;var t=Ar(),e=t(Object,"create");return _e=e,_e}var Se,Kt;function ua(){if(Kt)return Se;Kt=1;var t=Z();function e(){this.__data__=t?t(null):{},this.size=0}return Se=e,Se}var xe,Qt;function ha(){if(Qt)return xe;Qt=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return xe=t,xe}var Pe,$t;function da(){if($t)return Pe;$t=1;var t=Z(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(i){var o=this.__data__;if(t){var s=o[i];return s===e?void 0:s}return n.call(o,i)?o[i]:void 0}return Pe=a,Pe}var Ce,Jt;function fa(){if(Jt)return Ce;Jt=1;var t=Z(),e=Object.prototype,r=e.hasOwnProperty;function n(a){var i=this.__data__;return t?i[a]!==void 0:r.call(i,a)}return Ce=n,Ce}var Me,Ut;function ma(){if(Ut)return Me;Ut=1;var t=Z(),e="__lodash_hash_undefined__";function r(n,a){var i=this.__data__;return this.size+=this.has(n)?0:1,i[n]=t&&a===void 0?e:a,this}return Me=r,Me}var Te,Zt;function ga(){if(Zt)return Te;Zt=1;var t=ua(),e=ha(),r=da(),n=fa(),a=ma();function i(o){var s=-1,c=o==null?0:o.length;for(this.clear();++s<c;){var l=o[s];this.set(l[0],l[1])}}return i.prototype.clear=t,i.prototype.delete=e,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,Te=i,Te}var Oe,er;function va(){if(er)return Oe;er=1;function t(){this.__data__=[],this.size=0}return Oe=t,Oe}var ke,tr;function pa(){if(tr)return ke;tr=1;function t(e,r){return e===r||e!==e&&r!==r}return ke=t,ke}var De,rr;function ee(){if(rr)return De;rr=1;var t=pa();function e(r,n){for(var a=r.length;a--;)if(t(r[a][0],n))return a;return-1}return De=e,De}var qe,nr;function ya(){if(nr)return qe;nr=1;var t=ee(),e=Array.prototype,r=e.splice;function n(a){var i=this.__data__,o=t(i,a);if(o<0)return!1;var s=i.length-1;return o==s?i.pop():r.call(i,o,1),--this.size,!0}return qe=n,qe}var Ee,ar;function ba(){if(ar)return Ee;ar=1;var t=ee();function e(r){var n=this.__data__,a=t(n,r);return a<0?void 0:n[a][1]}return Ee=e,Ee}var Re,ir;function wa(){if(ir)return Re;ir=1;var t=ee();function e(r){return t(this.__data__,r)>-1}return Re=e,Re}var Le,sr;function _a(){if(sr)return Le;sr=1;var t=ee();function e(r,n){var a=this.__data__,i=t(a,r);return i<0?(++this.size,a.push([r,n])):a[i][1]=n,this}return Le=e,Le}var Ae,or;function Sa(){if(or)return Ae;or=1;var t=va(),e=ya(),r=ba(),n=wa(),a=_a();function i(o){var s=-1,c=o==null?0:o.length;for(this.clear();++s<c;){var l=o[s];this.set(l[0],l[1])}}return i.prototype.clear=t,i.prototype.delete=e,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,Ae=i,Ae}var Ie,cr;function xa(){if(cr)return Ie;cr=1;var t=Ar(),e=mt(),r=t(e,"Map");return Ie=r,Ie}var Fe,lr;function Pa(){if(lr)return Fe;lr=1;var t=ga(),e=Sa(),r=xa();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return Fe=n,Fe}var He,ur;function Ca(){if(ur)return He;ur=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return He=t,He}var Ne,hr;function te(){if(hr)return Ne;hr=1;var t=Ca();function e(r,n){var a=r.__data__;return t(n)?a[typeof n=="string"?"string":"hash"]:a.map}return Ne=e,Ne}var We,dr;function Ma(){if(dr)return We;dr=1;var t=te();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return We=e,We}var je,fr;function Ta(){if(fr)return je;fr=1;var t=te();function e(r){return t(this,r).get(r)}return je=e,je}var Ye,mr;function Oa(){if(mr)return Ye;mr=1;var t=te();function e(r){return t(this,r).has(r)}return Ye=e,Ye}var ze,gr;function ka(){if(gr)return ze;gr=1;var t=te();function e(r,n){var a=t(this,r),i=a.size;return a.set(r,n),this.size+=a.size==i?0:1,this}return ze=e,ze}var Ge,vr;function Da(){if(vr)return Ge;vr=1;var t=Pa(),e=Ma(),r=Ta(),n=Oa(),a=ka();function i(o){var s=-1,c=o==null?0:o.length;for(this.clear();++s<c;){var l=o[s];this.set(l[0],l[1])}}return i.prototype.clear=t,i.prototype.delete=e,i.prototype.get=r,i.prototype.has=n,i.prototype.set=a,Ge=i,Ge}var Ve,pr;function qa(){if(pr)return Ve;pr=1;var t=Da(),e="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(e);var i=function(){var o=arguments,s=a?a.apply(this,o):o[0],c=i.cache;if(c.has(s))return c.get(s);var l=n.apply(this,o);return i.cache=c.set(s,l)||c,l};return i.cache=new(r.Cache||t),i}return r.Cache=t,Ve=r,Ve}var Be,yr;function Ea(){if(yr)return Be;yr=1;var t=qa(),e=500;function r(n){var a=t(n,function(o){return i.size===e&&i.clear(),o}),i=a.cache;return a}return Be=r,Be}var Xe,br;function Ra(){if(br)return Xe;br=1;var t=Ea(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(a){var i=[];return a.charCodeAt(0)===46&&i.push(""),a.replace(e,function(o,s,c,l){i.push(c?l.replace(r,"$1"):s||o)}),i});return Xe=n,Xe}var Ke,wr;function La(){if(wr)return Ke;wr=1;function t(e,r){for(var n=-1,a=e==null?0:e.length,i=Array(a);++n<a;)i[n]=r(e[n],n,e);return i}return Ke=t,Ke}var Qe,_r;function Aa(){if(_r)return Qe;_r=1;var t=gt(),e=La(),r=ft(),n=vt(),a=t?t.prototype:void 0,i=a?a.toString:void 0;function o(s){if(typeof s=="string")return s;if(r(s))return e(s,o)+"";if(n(s))return i?i.call(s):"";var c=s+"";return c=="0"&&1/s==-1/0?"-0":c}return Qe=o,Qe}var $e,Sr;function Ia(){if(Sr)return $e;Sr=1;var t=Aa();function e(r){return r==null?"":t(r)}return $e=e,$e}var Je,xr;function Fa(){if(xr)return Je;xr=1;var t=ft(),e=na(),r=Ra(),n=Ia();function a(i,o){return t(i)?i:e(i,o)?[i]:r(n(i))}return Je=a,Je}var Ue,Pr;function Ha(){if(Pr)return Ue;Pr=1;var t=vt();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Ue=e,Ue}var Ze,Cr;function Na(){if(Cr)return Ze;Cr=1;var t=Fa(),e=Ha();function r(n,a){a=t(a,n);for(var i=0,o=a.length;n!=null&&i<o;)n=n[e(a[i++])];return i&&i==o?n:void 0}return Ze=r,Ze}var et,Mr;function Wa(){if(Mr)return et;Mr=1;var t=Na();function e(r,n,a){var i=r==null?void 0:t(r,n);return i===void 0?a:i}return et=e,et}var ja=Wa();const tt=Er(ja);function Ya(t,e,r={}){const{minTicks:n=5,maxTicks:a=10,baseStep:i=.1,decimalPlaces:o=2}=r;if(t>e&&([t,e]=[e,t]),t===e)return[t];const c=(e-t)/((n+a)/2),l=Math.pow(10,Math.floor(Math.log10(c/i))),h=c/(i*l),g=(h<=2?1:h<=5?2:5)*i*l,v=Math.ceil(t/g)*g,m=Math.floor(e/g)*g,y=[];for(let f=v;f<=m+g/2;f+=g)y.push(Number(f.toFixed(o)));return y}class za{constructor(e="ohlc",r="hour:1",n=5){this.el=document.createElement("canvas"),this.ctx=this.el.getContext("2d"),this.candlesInViewport=n,this.viewType=e,this.startingCandleShift=0,this.candleWidth=1,this.userMode=null,this.trainHighlights=[],this.trainingHistory=[],this.blockNewCalls=!1,this.data=[],this.levels=[],this.bidAsk=[],this.streaks=[],this.volumeProfiles=[],this.priceActions=null,this.sma=[],this.stdDev=[],this.renderedData=[],this.renderedLevels=[],this.renderedBidask=[],this.renderedStreaks=[],this.renderedVolumeProfiles=[],this.renderedPriceActions=[],this.renderedSma=[],this.renderedStdDev=[],this.renderedHighs=[],this.renderedLows=[],this.delayedRenderCalls=[],this.highs=[],this.lows=[],this.isPanning=!1,this.dataSlice={from:0,length:100},this.lineDataModel={x:0,y:0},this.ohlcDataModel={x:0,o:0,h:0,l:0,c:0},this.scaling={x:10,y:1},this.gap={minX:5,x:10,minY:5,y:10},this.movement={x:0,y:0},this.crosshairIndex=0,this.indicators={priceAction:!1,bidAsk:!1,volumeProfile:!1,streaks:!1,highLow:!1,sma:!1,priceLevel:!1},this.setSizes(),this.setXScaling(),this.crosshair={left:(this.el.height-this.timelineHorizontalControl.height)*.5,top:(this.el.height-this.timelineHorizontalControl.height)*.5},this.subcharts=[{viewType:"linear",yField:"extra.cvd",xField:"x",paddingTop:()=>(this.el.height-this.timelineHorizontalControl.height)*.666,paddingLeft:()=>0,height:()=>(this.el.height-this.timelineHorizontalControl.height)*.333,width:()=>this.el.width-this.valueVerticalControl.width}],this.setupListeners(),this.evaluations={evaluateVolumeAnomaly:a=>0,evaluatePositiveVD:a=>0,evaluateNegativeVD:a=>0},this.delayedRenderCalls.push(this.setCalculations)}nextTrainSituation(e){const r=this.renderedData.flatMap(n=>[n.extra.id,n.o,n.c,n.extra.cvd]);r.push(e),this.trainingHistory.push(r),this.delayedRenderCalls.push(this.setupNextTrainSituation)}setupNextTrainSituation(e){if(this.userMode==="train-ab-ex-patterns"){for(let n=e.length-1;n>0;n--)if(n>1&&n<e.length-2){const a=e[n-2],i=e[n-1],o=e[n],s=e[n+1],c=d=>Math.sign(d.c-d.o),l=c(i)===c(a),h=!this.trainHighlights.at(-1)||o.extra.id>this.trainHighlights.at(-1).extra.id+1;if(l&&c(s)!==c(a)&&h)return this.startingCandleShift=this.data.length-o.extra.id-1,this.trainHighlights.push(o),o}requestAnimationFrame(()=>{this.startingCandleShift--,this.delayedRenderCalls.push(this.setupNextTrainSituation)})}}enableMode(e){this.userMode=e,this.userMode==="train-ab-ex-patterns"?(this.scaling.x=20,trainAbExPaterns.style.visibility="visible",this.startingCandleShift=this.data.length-Math.floor(this.candlesInViewport*this.scaling.x)-100,this.delayedRenderCalls.push(this.setupNextTrainSituation)):(this.trainHighlights=[],this.startingCandleShift=0,trainAbExPaterns.style.visibility="hidden")}element(){return this.el}setSizes(){this.bodyBox=document.body.getBoundingClientRect(),this.el.width=this.bodyBox.width,this.el.height=this.bodyBox.height-10,this.valueVerticalControl={width:60,height:this.el.height},this.timelineHorizontalControl={with:this.el.width,height:60}}setCalculations(e){this.renderedLevels=[];for(const r of this.levels)if(r.tests.length>1){const n=F([r.tests.at(0),r.tests.at(-1)],[e.at(0).x,e.at(-1).x]);n.isOverlapping&&this.renderedLevels.push({price:r.price,timeStart:n.firstPoint,timeEnd:n.lastPoint,testsCount:r.tests.length})}this.renderedBidask=[];for(let r=0;r<this.bidAsk.length;r++){const n=this.bidAsk[r],a=this.bidAsk[r+1],i=F([n.time,(a==null?void 0:a.time)||Date.now()],[e.at(0).x,e.at(-1).x]);i.isOverlapping&&this.renderedBidask.push({timeStart:i.firstPoint,timeEnd:i.lastPoint,isBullish:n.isBullish})}this.renderedStreaks=[];for(const r of this.streaks)for(const n of r.deals){const a=F([n.from,n.to],[e.at(0).x,e.at(-1).x]);a.isOverlapping&&this.renderedStreaks.push({timeStart:a.firstPoint,timeEnd:a.lastPoint,isBullish:r.type==="win",stopLoss:n.stopLoss,takeProfit:n.takeProfit,enter:n.enter})}this.renderedVolumeProfiles=[];for(const r of this.volumeProfiles){const n=F([r.startedAt,r.endedAt],[e.at(0).x,e.at(-1).x]);n.isOverlapping&&this.renderedVolumeProfiles.push({timeStart:n.firstPoint,timeEnd:n.lastPoint,profile:r.profile,vah:r.vah,val:r.val,vpoc:r.vpoc,vpocVolume:r.profile[r.vpocIndex].volume,normality:r.normality})}if(this.renderedPriceActions=[],!!this.priceActions){for(let r=0;r<this.priceActions.priceEvents.length;r++){const n=this.priceActions.priceEvents[r],a=this.priceActions.priceEventsTimestamps[r],i=this.priceActions.priceEventsPrices[r],o=F([a,a+1],[e.at(0).x,e.at(-1).x]);o.isOverlapping&&this.renderedPriceActions.push({time:o.firstPoint,event:n,price:i})}this.renderedSma=this.sma.slice(this.dataSlice.from,this.dataSlice.length),this.renderedStdDev=this.stdDev.slice(this.dataSlice.from,this.dataSlice.length),this.renderedHighs=[];for(let r=0;r<this.highs.length;r++){const n=this.highs[r];F([n.time,n.time+1],[e.at(0).x,e.at(-1).x]).isOverlapping&&this.renderedHighs.push(n)}this.renderedLows=[];for(let r=0;r<this.lows.length;r++){const n=this.lows[r];F([n.time,n.time+1],[e.at(0).x,e.at(-1).x]).isOverlapping&&this.renderedLows.push(n)}}}setXScaling(e={deltaY:0}){this.scaling.x=Un(5,this.scaling.x*Math.pow(1.01,e.deltaY*.1),2e4),this.delayedRenderCalls.push(this.setCalculations)}handleMousePan(e){const r=this.startingCandleShift,n=this.crosshairIndex,a=o=>{this.isPanning=!0,this.movement.x+=o.movementX;const s=this.crosshairIndex-n;this.startingCandleShift=Math.max(0,Math.min(r+s,this.data.length-Math.floor(this.candlesInViewport*this.scaling.x)))},i=()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",i),this.isPanning=!1,this.movement.x=0,this.delayedRenderCalls.push(this.setCalculations)};document.addEventListener("mousemove",a),document.addEventListener("mouseup",i)}handleCrosshairMove(e){const r=this.el.getBoundingClientRect();this.crosshair.left=e.pageX-r.left,this.crosshair.top=e.pageY-r.top}setupListeners(){window.addEventListener("resize",this.setSizes.bind(this)),document.addEventListener("mousedown",this.handleMousePan.bind(this)),this.el.addEventListener("mousemove",this.handleCrosshairMove.bind(this)),this.el.addEventListener("wheel",this.setXScaling.bind(this))}setLevels(e){this.levels=e}setBidAsk(e){this.bidAsk=e}setStreaks(e){this.streaks=e}setVolumeProfiles(e){this.volumeProfiles=e}setPriceActions(e){this.priceActions=e}setSma(e){this.sma=e}setStdDev(e){this.stdDev=e}setHighs(e){this.highs=e}setLows(e){this.lows=e}automateRenderingForData(e){this.data.length===0&&(this.data=e,this.setCalculations(e.map(Ot))),requestAnimationFrame(()=>{this.renderData(this.data),this.automateRenderingForData(this.data)})}renderSubchart(e,r){const n=e.width(),a=e.height(),i=this.ctx;if(e.viewType==="linear"){const o=r.flatMap(b=>[tt(b,e.yField)]),s=K(o),c=Q(o),l=(c-s)*.1,h=Math.floor(s-l),g=Math.ceil(c+l)-h,v=r.map(b=>tt(b,e.xField));K(v),Q(v);const m=Math.floor(this.candlesInViewport*this.scaling.x),y=b=>{const S=(b-h)/g;return e.paddingTop()+a*(1-S)*this.scaling.y},f=b=>e.paddingLeft()+b/m*n;i.beginPath(),i.strokeStyle="blue",i.lineCap="round",i.lineJoin="round";for(let b=0;b<r.length;b++){const S=r[b],w=f(b),V=tt(S,e.yField),E=y(V);b===0?i.moveTo(w,E):i.lineTo(w,E)}i.stroke(),i.closePath()}}renderData(e){var h;const r=this.subcharts.reduce((d,g)=>d+g.height(),0),n=this.el.height-this.timelineHorizontalControl.height,a=this.el.width-this.valueVerticalControl.width,i=this.el.width-this.valueVerticalControl.width,o=this.el.height-this.timelineHorizontalControl.height-r,s=this.ctx,c=Math.floor(this.candlesInViewport*this.scaling.x);this.dataSlice={from:Math.max(e.length-c-this.startingCandleShift,0),length:Math.min(e.length,Math.max(e.length-this.startingCandleShift,c))};const l=e.slice(this.dataSlice.from,this.dataSlice.length).map(Ot);for(this.renderedData=l;this.delayedRenderCalls.length>0;)this.delayedRenderCalls.shift().call(this,l);if(this.viewType==="ohlc"){const d=l.flatMap(u=>[u.o,u.h,u.l,u.c]),g=K(d),v=Q(d),m=(v-g)*.1,y=Math.floor(g-m),f=Math.ceil(v+m),b=f-y,S=l.map(u=>u.x),w=K(S),E=Q(S)-w,x=u=>{const p=(u-y)/b;return o*(1-p)*this.scaling.y},Fr=u=>{const p=1-u/(o*this.scaling.y);return y+b*p},k=u=>{const p=(u-w)/E;return i*p*this.scaling.y},N=u=>u/c*i,Hr="rgba(26, 152, 129, 1)",Nr="rgba(239, 57, 74, 1)",Wr="#000000";i/(l.length-1);const R=i/c;if(this.candleWidth=R,s.fillStyle="#ffffff",s.fillRect(0,0,this.el.width,this.el.height),this.indicators.bidAsk)for(const u of this.renderedBidask){const p=k(u.timeStart),P=k(u.timeEnd),T=Math.abs(P-p);s.fillStyle=u.isBullish?"#15bf221f":"#ff000012",s.fillRect(p,0,T,o)}if(this.indicators.streaks)for(const u of this.renderedStreaks){const p=k(u.timeStart),P=k(u.timeEnd),T=Math.abs(P-p),O=x(u.stopLoss)-x(u.takeProfit);s.fillStyle=u.isBullish?"#25cd5159":"#cd252559",s.fillRect(p,x(u.takeProfit),T,O),s.beginPath(),s.strokeStyle="black";const D=x(u.enter);s.moveTo(p,D),s.lineTo(P,D),s.closePath(),s.stroke()}const pt=Ya(y,f);for(const u of pt){const p=x(u);s.beginPath(),s.strokeStyle="#ebebeb",s.lineWidth=1,s.moveTo(0,p),s.lineTo(this.el.width,p),s.stroke()}s.fillStyle="#ffffff",s.fillRect(i,0,this.valueVerticalControl.width,this.valueVerticalControl.height);for(const u of pt){const p=x(u);s.fillStyle="#000000",s.font="12px Arial",s.textAlign="center",s.fillText(u.toString(),i+this.valueVerticalControl.width*.5,p)}s.strokeStyle="lightgrey",s.moveTo(a,0),s.lineTo(a,n),s.stroke(),s.moveTo(0,n),s.lineTo(a,n),s.stroke();for(const u of this.subcharts)s.strokeStyle="lightgrey",s.moveTo(0,u.paddingTop()),s.lineTo(u.width(),u.paddingTop()),s.stroke();let yt=null;for(let u=0;u<l.length;u++){const p=l[u];Jn(s,{x:N(u),openY:x(p.o),closeY:x(p.c),highY:x(p.h),lowY:x(p.l),isRising:p.c>=p.o},{upColor:Hr,downColor:Nr,candleWidth:R,wickColor:Wr,clusters:[],clusterFiltration:2e4,evaluations:this.evaluations,extra:p.extra}),p.extra.id===((h=this.trainHighlights.at(-1))==null?void 0:h.extra.id)&&(s.fillStyle="#4e9bd94a",s.fillRect(N(u)-R*.5,0,R,n));const P=l[u-1];if(P&&P.o>P.c&&p.o>p.c&&p.extra.volumeDelta>0&&p.extra.volumeDelta/p.extra.volume>=.1){const T=N(u),O=x(p.l);s.fillStyle="purple",s.fillRect(T-R*.5,O+4,R,16)}p.extra.startOfDayDateFormatted!==yt&&(s.font="16px Arial",s.fillStyle="#303030",s.fillText(p.extra.startOfDayDateFormatted,N(u),n+this.timelineHorizontalControl.height*.5+8),yt=p.extra.startOfDayDateFormatted)}if(this.indicators.highLow){for(const u of this.renderedHighs)s.fillStyle="red",s.fillRect(k(u.time)-2,x(u.value)-2,4,4);for(const u of this.renderedLows)s.fillStyle="green",s.fillRect(k(u.time)-2,x(u.value)-2,4,4)}if(this.indicators.sma){s.beginPath(),s.strokeStyle="blue";for(let u=0;u<this.renderedSma.length;u++){const p=l[u],P=k(p.x),T=x(this.renderedSma[u]);s.lineTo(P,T),s.font="10px Arial",s.fillStyle="black",s.fillText(this.renderedStdDev[u].toFixed(2),P,T)}s.stroke(),s.closePath()}if(this.indicators.volumeProfile)for(const u of this.renderedVolumeProfiles){const p=k(u.timeStart),P=k(u.timeEnd),T=Math.abs(P-p);s.fillStyle="#000000",s.font="12px Arial",s.fillText(u.normality.toFixed(2),p,x(u.profile[0].price));for(let O=0;O<u.profile.length;O++){const D=u.profile[O],X=u.profile[O+1]||u.profile[O-1];let W="#80808073";D.price===u.vpoc&&(W="#4b88e373"),(D.price===u.val||D.price===u.vah)&&(W="#e34b4b73");const jr=D.volume/u.vpocVolume,wt=x(D.price);s.fillStyle=W;const Yr=Math.max(Math.abs(wt-x(X.price)),1);s.fillRect(p,wt,T*jr,Yr)}}if(this.indicators.priceAction)for(const u of this.renderedPriceActions)s.beginPath(),s.fillStyle="black",s.arc(k(u.time),x(u.price),4,0,2*Math.PI),s.fillStyle="black",s.font="14px Arial",s.fillText(u.event,k(u.time),x(u.price)),s.fill();if(this.indicators.priceLevel)for(let u=0;u<this.renderedLevels.length;u++)this.renderedLevels[u];for(const u of this.subcharts)this.renderSubchart(u,l);s.strokeStyle="black",s.strokeWidth=1,s.beginPath(),s.setLineDash([5,15]),s.moveTo(this.crosshair.left,0),s.lineTo(this.crosshair.left,n),s.closePath(),s.stroke(),s.beginPath(),s.moveTo(0,this.crosshair.top),s.lineTo(a,this.crosshair.top),s.closePath(),s.stroke(),s.setLineDash([]);const B=Math.floor((this.crosshair.left+R*.5)/this.candleWidth),bt=l[B];if(this.crosshairIndex=B,bt){s.fillStyle="#4e9bd94a",s.fillRect(N(B)-R*.5,0,R,n),s.fillStyle="#43495d8c";const u=124,p=32,P=N(B)+R*.5+4,T=n-p;s.fillRect(P,T,u,p),s.fillStyle="white",s.fillText(bt.extra.dateFormatted,P+u/2,T+p/2+4),s.fillStyle="#43495d8c";const O=84,D=32,X=a-this.valueVerticalControl.width-O*.3,W=this.crosshair.top+4;s.fillRect(X,W,O,D),s.fillStyle="white",s.fillText(Fr(this.crosshair.top).toFixed(2),X+O/2,W+D/2+4)}}else this.viewType}}var rt={exports:{}},Tr;function Ga(){return Tr||(Tr=1,function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,l,h){this.fn=c,this.context=l,this.once=h||!1}function i(c,l,h,d,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,d||c,g),m=r?r+l:l;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],v]:c._events[m].push(v):(c._events[m]=v,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new n:delete c._events[l]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var l=[],h,d;if(this._eventsCount===0)return l;for(d in h=this._events)e.call(h,d)&&l.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(h)):l},s.prototype.listeners=function(l){var h=r?r+l:l,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var g=0,v=d.length,m=new Array(v);g<v;g++)m[g]=d[g].fn;return m},s.prototype.listenerCount=function(l){var h=r?r+l:l,d=this._events[h];return d?d.fn?1:d.length:0},s.prototype.emit=function(l,h,d,g,v,m){var y=r?r+l:l;if(!this._events[y])return!1;var f=this._events[y],b=arguments.length,S,w;if(f.fn){switch(f.once&&this.removeListener(l,f.fn,void 0,!0),b){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,h),!0;case 3:return f.fn.call(f.context,h,d),!0;case 4:return f.fn.call(f.context,h,d,g),!0;case 5:return f.fn.call(f.context,h,d,g,v),!0;case 6:return f.fn.call(f.context,h,d,g,v,m),!0}for(w=1,S=new Array(b-1);w<b;w++)S[w-1]=arguments[w];f.fn.apply(f.context,S)}else{var V=f.length,E;for(w=0;w<V;w++)switch(f[w].once&&this.removeListener(l,f[w].fn,void 0,!0),b){case 1:f[w].fn.call(f[w].context);break;case 2:f[w].fn.call(f[w].context,h);break;case 3:f[w].fn.call(f[w].context,h,d);break;case 4:f[w].fn.call(f[w].context,h,d,g);break;default:if(!S)for(E=1,S=new Array(b-1);E<b;E++)S[E-1]=arguments[E];f[w].fn.apply(f[w].context,S)}}return!0},s.prototype.on=function(l,h,d){return i(this,l,h,d,!1)},s.prototype.once=function(l,h,d){return i(this,l,h,d,!0)},s.prototype.removeListener=function(l,h,d,g){var v=r?r+l:l;if(!this._events[v])return this;if(!h)return o(this,v),this;var m=this._events[v];if(m.fn)m.fn===h&&(!g||m.once)&&(!d||m.context===d)&&o(this,v);else{for(var y=0,f=[],b=m.length;y<b;y++)(m[y].fn!==h||g&&!m[y].once||d&&m[y].context!==d)&&f.push(m[y]);f.length?this._events[v]=f.length===1?f[0]:f:o(this,v)}return this},s.prototype.removeAllListeners=function(l){var h;return l?(h=r?r+l:l,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,t.exports=s}(rt)),rt.exports}var Va=Ga();const Ba=Er(Va);class Xa extends Ba{constructor(){super();const e=document.getElementById("drop-area"),r=document.getElementById("file-info"),n=document.getElementById("loading-bar");["dragenter","dragover","dragleave","drop"].forEach(a=>{document.body.addEventListener(a,i=>i.preventDefault())}),document.body.addEventListener("dragenter",()=>{e.classList.add("visible")}),document.body.addEventListener("dragover",()=>{e.classList.add("dragover")}),document.body.addEventListener("dragleave",a=>{(a.relatedTarget===null||!e.contains(a.relatedTarget))&&e.classList.remove("dragover","visible")}),document.body.addEventListener("drop",a=>{e.classList.remove("dragover");const i=a.dataTransfer.files;if(i.length>0){const o=i[0];if(r.innerHTML=`File: ${o.name}<br>Size: ${(o.size/1024).toFixed(2)} KB<br>Type: ${o.type||"Unknown"}`,n.classList.add("visible"),o.type==="application/json"){const s=new FileReader;s.onload=c=>{this.emit("file-drop",c.target.result),setTimeout(()=>{e.classList.remove("visible"),n.classList.remove("visible"),r.innerHTML=""},5e3)},s.readAsText(o)}}else e.classList.remove("visible")})}}class Ka{constructor(e="LocalStorageDB",r="keyValueStore"){this.dbName=e,this.storeName=r,this.db=null}async init(){if(!this.db)return new Promise((e,r)=>{const n=indexedDB.open(this.dbName,1);n.onupgradeneeded=a=>{const i=a.target.result;i.objectStoreNames.contains(this.storeName)||i.createObjectStore(this.storeName,{keyPath:"key"})},n.onsuccess=a=>{this.db=a.target.result,e()},n.onerror=a=>{r(a.target.error)}})}async setItem(e,r){return await this.init(),new Promise((n,a)=>{const s=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).put({key:e,value:r});s.onsuccess=()=>n(),s.onerror=c=>a(c.target.error)})}async getItem(e){return await this.init(),new Promise((r,n)=>{const o=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);o.onsuccess=s=>{const c=s.target.result;r(c?c.value:null)},o.onerror=s=>n(s.target.error)})}}const Qa=document.getElementById("app"),M=new za;Qa.appendChild(M.element());const $a=new Xa;modeChangeSelect.addEventListener("change",t=>{t.target.value==="train-ab-ex-patterns"?M.enableMode("train-ab-ex-patterns"):M.enableMode(null)});trainAbExPaterns.addEventListener("click",t=>{var e;["bearish-exhaustion","bearish-absorption","bullish-exhaustion","bullish-absorption","skip"].includes((e=t.target)==null?void 0:e.value)&&M.nextTrainSituation(t.target.value)});const at="assetCandlestics",it="priceLevels",st="bidAsk",ot="streaks",ct="volumeProfiles",lt="priceActions",ut="volatility",ht="extremum",C=new Ka,dt={price:0,volume:1,bid:2,ask:3,volumeDelta:4,position:5,evaluation:6,absorption:7};function Ja(t){const e={};for(const r of Object.keys(dt))e[r]=t[dt[r]];return e}const L=async t=>{try{const{message:e}=JSON.parse(t.data);if(e[at]){console.log(e),await C.setItem(at,t.data);const r=e.assetCandlestics.map(n=>({...n,clusters:Object.fromEntries(n.clusters.map(a=>[a[dt.price].toString(),Ja(a)]))}));M.renderData(r),M.automateRenderingForData(r)}else e[it]?(await C.setItem(it,t.data),M.setLevels(e.priceLevels)):e[st]?(await C.setItem(st,t.data),M.setBidAsk(e.bidAsk)):e[ot]?(await C.setItem(ot,t.data),M.setStreaks(e.streaks)):e[ct]?(await C.setItem(ct,t.data),M.setVolumeProfiles(e.volumeProfiles)):e[lt]?(await C.setItem(lt,t.data),M.setPriceActions(e.priceActions)):e[ut]?(await C.setItem(ut,t.data),M.setSma(e.volatility.sma),M.setStdDev(e.volatility.stdDev)):e[ht]&&(await C.setItem(ht,t.data),M.setHighs(e.extremum.highs),M.setLows(e.extremum.lows))}catch(e){console.error(e)}};$a.on("file-drop",async t=>{await L({data:t})});const Ir=()=>{let t=new WebSocket("ws://localhost:9092");t.onmessage=L,t.onopen=()=>{console.log("ws reconnected",new Date().toLocaleTimeString())},t.onclose=()=>{t=null,setTimeout(Ir,1e3)},t.onerror=e=>{console.error(e)}},Ua=async()=>{const t=await C.getItem(at);t&&L({data:t});const e=await C.getItem(it);e&&L({data:e});const r=await C.getItem(st);r&&L({data:r});const n=await C.getItem(ot);n&&L({data:n});const a=await C.getItem(ct);a&&L({data:a});const i=await C.getItem(lt);i&&L({data:i});const o=await C.getItem(ut);o&&L({data:o});const s=await C.getItem(ht);s&&L({data:s})};Ua();Ir();
